<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Transient.EVars</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Transient-EVars.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">transient-0.4.0: Making composable programs with multithreading, events and distributed computing</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Transient.EVars</p></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:EVar">EVar</a> a = <a href="#v:EVar">EVar</a> <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Data-Int.html#t:Int">Int</a> (<a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/GHC-Conc.html#t:TVar">TVar</a> (<a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Data-Int.html#t:Int">Int</a>, <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Data-Int.html#t:Int">Int</a>)) (TChan (<a href="Transient-Internals.html#t:StreamData">StreamData</a> a))</li><li class="src short"><a href="#v:newEVar">newEVar</a> :: <a href="Transient-Internals.html#t:TransIO">TransIO</a> (<a href="Transient-EVars.html#t:EVar">EVar</a> a)</li><li class="src short"><a href="#v:cleanEVar">cleanEVar</a> :: <a href="Transient-EVars.html#t:EVar">EVar</a> a -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> ()</li><li class="src short"><a href="#v:readEVar">readEVar</a> :: <a href="Transient-EVars.html#t:EVar">EVar</a> a -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> a</li><li class="src short"><a href="#v:writeEVar">writeEVar</a> :: <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Transient-EVars.html#t:EVar">EVar</a> t -&gt; t -&gt; m ()</li><li class="src short"><a href="#v:lastWriteEVar">lastWriteEVar</a> :: <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Transient-EVars.html#t:EVar">EVar</a> t -&gt; t -&gt; m ()</li><li class="src short"><span class="keyword">type</span> <a href="#t:FinishReason">FinishReason</a> = <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Control-Exception-Base.html#t:SomeException">SomeException</a></li><li class="src short"><a href="#v:checkFinalize">checkFinalize</a> :: <a href="Transient-Internals.html#t:StreamData">StreamData</a> a -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> a</li><li class="src short"><span class="keyword">data</span> <a href="#t:Finish">Finish</a> = <a href="#v:Finish">Finish</a> (<a href="Transient-EVars.html#t:EVar">EVar</a> <a href="Transient-EVars.html#t:FinishReason">FinishReason</a>)</li><li class="src short"><a href="#v:initFinish">initFinish</a> :: <a href="Transient-Internals.html#t:TransIO">TransIO</a> <a href="Transient-EVars.html#t:Finish">Finish</a></li><li class="src short"><a href="#v:onFinish">onFinish</a> :: (<a href="Transient-EVars.html#t:FinishReason">FinishReason</a> -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> ()) -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> ()</li><li class="src short"><a href="#v:finish">finish</a> :: <a href="Transient-EVars.html#t:FinishReason">FinishReason</a> -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> ()</li><li class="src short"><a href="#v:unFinish">unFinish</a> :: <a href="Transient-Internals.html#t:TransIO">TransIO</a> ()</li><li class="src short"><a href="#v:killOnFinish">killOnFinish</a> :: <a href="Transient-Internals.html#t:TransIO">TransIO</a> b -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> b</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:EVar" class="def">EVar</a> a <a href="#t:EVar" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:EVar" class="def">EVar</a> <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Data-Int.html#t:Int">Int</a> (<a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/GHC-Conc.html#t:TVar">TVar</a> (<a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Data-Int.html#t:Int">Int</a>, <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Data-Int.html#t:Int">Int</a>)) (TChan (<a href="Transient-Internals.html#t:StreamData">StreamData</a> a))</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:newEVar" class="def">newEVar</a> :: <a href="Transient-Internals.html#t:TransIO">TransIO</a> (<a href="Transient-EVars.html#t:EVar">EVar</a> a) <a href="#v:newEVar" class="selflink">#</a></p><div class="doc"><p>creates an EVar.</p><p>Evars are event vars. <code><a href="Transient-EVars.html#v:writeEVar">writeEVar</a></code> trigger the execution of all the continuations associated to the  <code><a href="Transient-EVars.html#v:readEVar">readEVar</a></code> of this variable
 (the code that is after them).</p><p>It is like the publish-subscribe pattern but without inversion of control, since a readEVar can be inserted at any place in the
 Transient flow.</p><p>EVars are created upstream and can be used to communicate two sub-threads of the monad. Following the Transient philosophy they
 do not block his own thread if used with alternative operators, unlike the IORefs and TVars. And unlike STM vars, that are composable,
 they wait for their respective events, while TVars execute the whole expression when any variable is modified.</p><p>The execution continues after the writeEVar when all subscribers have been executed.</p><p>Now the continuations are executed in parallel.</p><p>see <a href="https://www.fpcomplete.com/user/agocorona/publish-subscribe-variables-transient-effects-v">https://www.fpcomplete.com/user/agocorona/publish-subscribe-variables-transient-effects-v</a></p></div></div><div class="top"><p class="src"><a id="v:cleanEVar" class="def">cleanEVar</a> :: <a href="Transient-EVars.html#t:EVar">EVar</a> a -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> () <a href="#v:cleanEVar" class="selflink">#</a></p><div class="doc"><p>delete al the subscriptions for an evar.</p></div></div><div class="top"><p class="src"><a id="v:readEVar" class="def">readEVar</a> :: <a href="Transient-EVars.html#t:EVar">EVar</a> a -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> a <a href="#v:readEVar" class="selflink">#</a></p><div class="doc"><p>read the EVar. It only succeed when the EVar is being updated
 The continuation gets registered to be executed whenever the variable is updated.</p><p>if readEVar is re-executed in any kind of loop, since each continuation is different, this will register
 again. The effect is that the continuation will be executed multiple times
 To avoid multiple registrations, use <code><a href="Transient-EVars.html#v:cleanEVar">cleanEVar</a></code></p></div></div><div class="top"><p class="src"><a id="v:writeEVar" class="def">writeEVar</a> :: <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Transient-EVars.html#t:EVar">EVar</a> t -&gt; t -&gt; m () <a href="#v:writeEVar" class="selflink">#</a></p><div class="doc"><p>update the EVar and execute all readEVar blocks with &quot;last in-first out&quot; priority</p></div></div><div class="top"><p class="src"><a id="v:lastWriteEVar" class="def">lastWriteEVar</a> :: <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Transient-EVars.html#t:EVar">EVar</a> t -&gt; t -&gt; m () <a href="#v:lastWriteEVar" class="selflink">#</a></p><div class="doc"><p>write the EVar and drop all the <code><a href="Transient-EVars.html#v:readEVar">readEVar</a></code> handlers.</p><p>It is like a combination of <code><a href="Transient-EVars.html#v:writeEVar">writeEVar</a></code> and <code><a href="Transient-EVars.html#v:cleanEVar">cleanEVar</a></code></p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FinishReason" class="def">FinishReason</a> = <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///opt/ghc/8.0.1/share/doc/ghc-8.0.1/html/libraries/base-4.9.0.0/Control-Exception-Base.html#t:SomeException">SomeException</a> <a href="#t:FinishReason" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:checkFinalize" class="def">checkFinalize</a> :: <a href="Transient-Internals.html#t:StreamData">StreamData</a> a -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> a <a href="#v:checkFinalize" class="selflink">#</a></p><div class="doc"><p>trigger finish when the stream data return SDone</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Finish" class="def">Finish</a> <a href="#t:Finish" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Finish" class="def">Finish</a> (<a href="Transient-EVars.html#t:EVar">EVar</a> <a href="Transient-EVars.html#t:FinishReason">FinishReason</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:initFinish" class="def">initFinish</a> :: <a href="Transient-Internals.html#t:TransIO">TransIO</a> <a href="Transient-EVars.html#t:Finish">Finish</a> <a href="#v:initFinish" class="selflink">#</a></p><div class="doc"><p>initialize the event variable for finalization.
 all the following computations in different threads will share it</p></div></div><div class="top"><p class="src"><a id="v:onFinish" class="def">onFinish</a> :: (<a href="Transient-EVars.html#t:FinishReason">FinishReason</a> -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> ()) -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> () <a href="#v:onFinish" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:finish" class="def">finish</a> :: <a href="Transient-EVars.html#t:FinishReason">FinishReason</a> -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> () <a href="#v:finish" class="selflink">#</a></p><div class="doc"><p>trigger the event, so this closes all the resources</p></div></div><div class="top"><p class="src"><a id="v:unFinish" class="def">unFinish</a> :: <a href="Transient-Internals.html#t:TransIO">TransIO</a> () <a href="#v:unFinish" class="selflink">#</a></p><div class="doc"><p>deregister all the finalization actions.
 A initFinish is needed to register actions again</p></div></div><div class="top"><p class="src"><a id="v:killOnFinish" class="def">killOnFinish</a> :: <a href="Transient-Internals.html#t:TransIO">TransIO</a> b -&gt; <a href="Transient-Internals.html#t:TransIO">TransIO</a> b <a href="#v:killOnFinish" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.2</p></div></body></html>